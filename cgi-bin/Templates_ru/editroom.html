<html>
<head>
	{IF|$input.createnew}
		{NEED_PERMISSION|rooms_create}
	{ELSE}
		{NEED|$room_information}
		{IF|$room_information.owner.name ne $current_user.name}
			{NEED_PERMISSION|rooms_modify}
			{IF|$current_user.tempgroup <= $room_information.owner.group}
				{ERROR|roomlist_nopermission}
			{ENDIF}
		{ENDIF}
	{ENDIF}
	<base href="{GET|$settings.urls.htmlurl}">
	<link rel="stylesheet" href="{GET|$runtime.style}.css">
	<title>
		{GET|$settings.chatname} -
		{IF|$input.createnew}
			Новая комната
		{ELSE}
			Редактирование комнаты {GET|$room_information.name}
		{ENDIF}
	</title>
	<script language="JavaScript">
		// Copy data from the dummy checkbox fields
		function copyDummies(form)
		{
			if (form.closed_dummy)
				form.closed.value = form.closed_dummy.checked ? 1 : 0;
			if (form.permanent_dummy)
				form.permanent.value = form.permanent_dummy.checked ? 1 : 0;
			if (form.moderated_dummy)
				form.moderated.value = form.moderated_dummy.checked ? 1 : 0;
		}
	</script>
</head>

<body onload="opener.autosize(window)">

<form method=POST action="{GET|$runtime.chaturl}" onsubmit="copyDummies(this)">
{GET|$runtime.hiddenfields}
<input type="hidden" name="action" value="modifyroom">
<input type="hidden" name="modify" value="{IIF|$input.createnew|0|1}">

<table border=0 width="100%" cellspacing=0 cellpadding=0 class="outer"><tr><td>
<table border=0 width="100%" cellspacing=1 cellpadding=0>

<tr>
	<th>
		{IF|$input.createnew}
			Новая комната
		{ELSE}
			Редактирование комнаты {GET|$room_information.name}
		{ENDIF}
	</th>
</tr>
<tr class="row2"><td><table width="100%" cellspacing=5>
	<tr>
		<td>Название:</td>
		<td>
			{IF|$input.createnew}
				<input type=text name=name size=30 style="width:100%" maxlength="{GET|$settings.check_room_fields_length.name[0]}">
			{ELSE}
				{GET|$room_information.name}<INPUT type=hidden name=name value="{GET|$room_information.name}">
			{ENDIF}
		</td>
	</tr>

	<tr>
		<td>Тема:</td>
		<td width="100%">
			<input type=text name=topic size=30 style="width:100%" maxlength="{GET|$settings.check_room_fields_length.topic[0]}" value="{GET|$room_information.topic}">
		</td>
	</tr>

	<tr>
		<td>Владелец:</td>
		<td>
			{IF|permission(rooms_changeowner)}
				{IF|$input.createnew}
					<input type=text name=owner size=30 style="width:100%" maxlength=255 value="{GET|$current_user.nick}">
				{ELSE}
					<input type=text name=owner size=30 style="width:100%" maxlength=255 value="{GET|$room_information.owner.nick}">
				{ENDIF}
			{ELSE}
				{IF|$input.createnew}
					{GET|$current_user.nick}<input type=hidden name=owner value="{GET|$current_user.nick}">
				{ELSE}
					{GET|$room_information.owner.nick}<input type=hidden name=owner value="{GET|$room_information.owner.nick}">
				{ENDIF}
			{ENDIF}
		</td>
	</tr>

	<tr>
		<td>Частная:</td>
		<td>
			{IF|$room_information.default}
				нет<input type=hidden name=closed value="0">
			{ELSE}
				{IF|permission(rooms_createprivate)}
					{IF|permission(rooms_createpublic)}
						<input type=hidden name=closed><input type=checkbox name="closed_dummy" value="1" {IIF|$room_information.closed|checked}>
					{ELSE}
						{IF|$input.createnew}
							да<input type=hidden name=closed value="1">
						{ELSE}
							{IIF|$room_information.closed|да<input type=hidden name=closed value="1">|нет<input type=hidden name=closed value="0">}
						{ENDIF}
					{ENDIF}
				{ELSE}
					{IF|$input.createnew}
						нет<input type=hidden name=closed value="0">
					{ELSE}
						{IIF|$room_information.closed|да<input type=hidden name=closed value="1">|нет<input type=hidden name=closed value="0">}
					{ENDIF}
				{ENDIF}
			{ENDIF}
		</td>
	</tr>

	<tr>
		<td>Постоянная:</td>
		<td>
			{IF|$room_information.default}
				да<input type=hidden name=permanent value="1">
			{ELSE}
				{IF|permission(rooms_createpermanent)}
					<input type=hidden name=permanent><input type=checkbox name="permanent_dummy" value="1" {IIF|$room_information.permanent|checked}>
				{ELSE}
					{IF|$input.createnew}
						нет<input type=hidden name=permanent value="0">
					{ELSE}
						{IIF|$room_information.permanent|да<input type=hidden name=permanent value="1">|нет<input type=hidden name=permanent value="0">}
					{ENDIF}
				{ENDIF}
			{ENDIF}
		</td>
	</tr>

	<tr>
		<td>Модерированная:</td>
		<td>
			{IF|permission(rooms_createmoderated)}
				<input type=hidden name=moderated><input type=checkbox name="moderated_dummy" value="1" {IIF|$room_information.moderated|checked}>
			{ELSE}
				{IF|$input.createnew}
					нет<input type=hidden name=moderated value="0">
				{ELSE}
					{IIF|$room_information.moderated|да<input type=hidden name=moderated value="1">|нет<input type=hidden name=moderated value="0">}
				{ENDIF}
			{ENDIF}
		</td>
	</tr>

	<tr>
		<td colspan=2>&nbsp;</td>
	</tr>
	
	<tr>
		<td colspan=2 align=center>
			<input type=submit value="{IIF|$input.createnew|Создать комнату|Записать изменения}">
			{IF|!$input.createnew and !$room_information.default}
				<input type=submit value="Удалить комнату" onClick="if (!confirm('Вы уверены, что действительно хотите удалить эту комнату? Учите, что эта операция необратима!')) return false; form.action.value='deleteroom'">
			{ENDIF}
		</td>
	</tr>

</table></td></tr>

</table>
</td></tr></table>
</form>

<div class="headertext" align="center">
	<a href="javascript:window.close()" class="stdlink">Закрыть окно</a>
</div>

</body>
</html> 